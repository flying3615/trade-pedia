import type { Strategy } from '../../../../lib/options/types'

const strategy: Strategy = {
  id: 'box-spread',
  name: '箱形价差 / 转换（Box Spread / Conversion）',
  referencePrice: 100,
  tags: ['方向：中性', '锁定/套利', '风险/收益：有限'],
  summary: '由一组看涨/看跌价差组合而成，到期价值与标的价格无关，理论上可用于锁定价差。',
  description: '箱形价差是一种高级期权策略，通过同时构建牛市价差和熊市价差来创建一个与标的价格无关的套利机会。最常见的形式是"多头箱形"，包括买入牛市看涨价差和买入熊市看跌价差。无论到期时标的价格如何，策略的理论价值都等于两个执行价之间的差额。',
  concept: '箱形价差就像是金融世界中的"保险箱"。你把不同方向的期权组合起来，创造出一个无论市场涨跌都能锁定固定收益的工具。就像把不同面额的硬币放进一个箱子里，不管你如何摇晃，箱子里硬币的总价值不会改变。这个策略的目标是利用市场定价的不完美，找到"免费午餐"的机会。',
  pros: [
    '**风险可控**：理论上最大风险和收益都是确定的，与标的价格波动无关。',
    '**套利机会**：当市场定价偏离理论价值时，可能存在无风险套利空间。',
    '**对冲工具**：可用于锁定其他策略的收益或对冲投资组合的风险。',
    '**方向中性**：不需要预测市场方向，适合震荡市场。',
  ],
  cons: [
    '**复杂度高**：涉及多个期权腿，构建和管理较为复杂。',
    '**成本敏感**：交易成本、保证金要求和资金成本会严重影响盈利空间。',
    '**机会稀少**：在高效市场中，真正的套利机会很少且稍纵即逝。',
    '**流动性要求**：需要同时交易多个期权，对流动性要求较高。',
  ],
  example: (
    <div>
      <p>假设某股票现价100元，你发现了一个可能的套利机会。于是你构建了一个多头箱形价差：</p>
      <ul>
        <li>买入1张执行价95元的看涨期权，支付7元（共700元）。</li>
        <li>卖出1张执行价105元的看涨期权，收入3元（共300元）。</li>
        <li>买入1张执行价105元的看跌期权，支付7元（共700元）。</li>
        <li>卖出1张执行价95元的看跌期权，收入3元（共300元）。</li>
      </ul>
      <p>你的净成本为 <strong>800元</strong>（700-300+700-300）。</p>
      <p><strong>理论价值</strong></p>
      <p>无论到期时股价是多少，这个组合的理论价值都是 <strong>1000元</strong>（105-95）×100）。</p>
      <p><strong>情景分析</strong></p>
      <p>无论股价到期时低于95元、介于95-105元之间，还是高于105元，你的最终收益都是相同的：1000元 - 800元 = <strong>200元</strong>。</p>
      <p><strong>现实考虑</strong></p>
      <p>这是理论上的完美情况。实际交易中还需要考虑交易成本、保证金占用、资金成本等因素，这些都会减少甚至消除套利空间。</p>
    </div>
  ),
  formula: [
    '理论价值 = (高执行价 - 低执行价) × 合约乘数',
    '净利润 = 理论价值 - 初始净成本',
    '最大风险 = 初始净成本（如果构建为空头箱形）',
    '盈亏平衡点：不存在（理论上无风险）',
  ],
  legs: [
    { id: 'lc95', kind: 'option', position: 'long', qty: 1, multiplier: 100, entryPrice: 7, option: { type: 'call', strike: 95 } },
    { id: 'sc105', kind: 'option', position: 'short', qty: 1, multiplier: 100, entryPrice: 3, option: { type: 'call', strike: 105 } },
    { id: 'lp105', kind: 'option', position: 'long', qty: 1, multiplier: 100, entryPrice: 7, option: { type: 'put', strike: 105 } },
    { id: 'sp95', kind: 'option', position: 'short', qty: 1, multiplier: 100, entryPrice: 3, option: { type: 'put', strike: 95 } },
  ],
}

export default strategy
