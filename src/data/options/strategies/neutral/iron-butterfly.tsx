import type { Strategy } from '../../../../lib/options/types';

const strategy: Strategy = {
  id: 'iron-butterfly',
  name: '铁蝶式 (Iron Butterfly)',
  referencePrice: 100,
  tags: ['方向：中性', '收取权利金', '风险/收益：有限'],
  summary: '卖出一个平价的跨式期权，同时买入一个两翼的宽跨式期权作为保护，以博取股价在目标价位附近盘整的收益。',
  description: '铁蝶式是一种中性策略，适用于预期股价在未来一段时间内波动性很小，会稳定在某个特定价格附近的情况。它通过收取净权利金建立头寸，在中间执行价达到最大利润。如果股价大幅上涨或下跌，亏损将被限制。该策略与蝶式价差的盈亏曲线完全相同，但完全由不同类型的期权（或看涨/看跌组合）构成。',
  concept: '这同样是为股价设置一个“精准的靶心”。你卖出一个跨式期权（赌股价不动），收取一笔可观的权利金。但为了防止“黑天鹅”事件，你又花一部分钱买了一个宽跨式期权作为“保险”。只要股价最终停在靶心（中间执行价）附近，你就能稳赚大部分权利金。离靶心越近，赚得越多。',
  pros: [
    '**收取权利金**：策略建立时立即产生现金流。',
    '**风险有限**：最大亏损是确定的。',
    '**高潜在回报率**：如果股价精确地收在中间执行价，投资回报率会非常高。',
  ],
  cons: [
    '**盈利区间狭窄**：只有当股价停留在非常窄的范围内时才能盈利。',
    '**潜在亏损大于收益**：最大潜在亏损通常大于最大潜在收益。',
    '**四腿交易**：建立和管理四条腿的交易更复杂，交易成本也更高。',
  ],
  example: (
    <div>
      <p>你预测Q公司股票（当前股价$100）在一个月后会非常接近$100。于是你建立了一个铁蝶式策略：</p>
      <ul>
        <li>卖出1张执行价为$100的看涨期权，收入$3/股。</li>
        <li>卖出1张执行价为$100的看跌期权，收入$3/股。</li>
        <li>买入1张执行价为$106的看涨期权，花费$1/股。</li>
        <li>买入1张执行价为$94的看跌期权，花费$1/股。</li>
      </ul>
      <p>你总共获得了 <strong>$400</strong> 的净权利金 ($300 + $300 - $100 - $100)，这是你的最大潜在利润。</p>
      <p><strong>情景一：股价到期时收于$100（理想情况）</strong></p>
      <p>所有期权都变为废纸，你将赚取全部初始收入 <strong>$400</strong>。</p>
      <p><strong>情景二：股价到期时收于$94或$106之外</strong></p>
      <p>例如，股价跌至$90。你的$100看跌期权亏损$1000，但$94看跌期权盈利$400。净亏损为$600。减去$400的净收入，最终亏损为 <strong>$200</strong>。这是最大亏损。</p>
      <p><strong>盈亏平衡点</strong></p>
      <p>此策略的盈亏平衡点是 <em>$100 - $4 = $96</em> 和 <em>$100 + $4 = $104</em>。股价在$96到$104之间是你的盈利区间。</p>
    </div>
  ),
  formula: [
    '最大盈利 = 收到的净权利金',
    '最大亏损 = (翼宽 - 每股净权利金) × 合约乘数',
    '上方盈亏平衡点 = 中间执行价 + 每股净权利金',
    '下方盈亏平衡点 = 中间执行价 - 每股净权利金',
  ],
  legs: [
    { id: 'sc', kind: 'option', position: 'short', qty: 1, multiplier: 100, entryPrice: 3, option: { type: 'call', strike: 100 } },
    { id: 'sp', kind: 'option', position: 'short', qty: 1, multiplier: 100, entryPrice: 3, option: { type: 'put', strike: 100 } },
    { id: 'bc', kind: 'option', position: 'long', qty: 1, multiplier: 100, entryPrice: 1, option: { type: 'call', strike: 106 } },
    { id: 'bp', kind: 'option', position: 'long', qty: 1, multiplier: 100, entryPrice: 1, option: { type: 'put', strike: 94 } },
  ],
};

export default strategy;
