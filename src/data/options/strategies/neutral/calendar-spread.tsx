import type { Strategy } from '../../../../lib/options/types'

const strategy: Strategy = {
  id: 'calendar-spread',
  name: '日历价差（Calendar Spread）',
  referencePrice: 100,
  tags: ['方向：中性', '波动率：看涨', '波动率：看跌', '时间价值差'],
  summary: '通过买卖不同到期日的期权来获利，分为买入型（多头）和卖出型（空头）两种，核心在于利用时间价值衰减速度和波动率预期的差异。',
  description: `日历价差（Calendar Spread）是一种利用时间价值和波动率差异进行交易的策略，主要分为以下两种类型：

1.  **买入日历价差（多头日历价差）**：**买入远月期权，同时卖出相同执行价的近月期权。**
    *   **逻辑**：利用近月期权比远月期权时间价值（Theta）衰减更快，同时远月期权对波动率（Vega）更敏感的特点。
    *   **适用场景**：预期标的资产价格在执行价附近窄幅整理，同时预期隐含波动率将上升。

2.  **卖出日历价差（空头日历价差）**：**卖出远月期权，同时买入相同执行价的近月期权。**
    *   **逻辑**：与买入日历价差相反，该策略在时间流逝中会产生亏损（因为买入的近月腿时间价值衰减更快），但能从隐含波动率的下降中获利。
    *   **适用场景**：预期隐含波动率将显著下降，或者预期标的资产价格将出现大幅波动，远离执行价。`,
  concept: '买入日历价差就像是租房合同的游戏。你卖出一份短期租约（近月期权）收租金，同时自己签一份长期租约（远月期权）付租金。你的目标是短期租约到期后，如果房客不续租，你还能继续用长期租约住。时间对你有利，因为短期租约的时间价值流失得比长期租约快得多。卖出日历价差则相反，相当于你认为长期租约的价格被高估了，愿意承担时间流逝的成本来赌波动率会下降。',
  pros: [
    '#### **买入日历价差（多头）**',
    '**时间价值优势**：近月期权时间价值衰减速度快于远月期权，对策略有利。',
    '**波动率敏感**：如果市场波动率上升，远月期权受益更多，可以放大收益。',
    '**风险可控**：最大风险是初始净成本，风险相对有限。',
    '#### **卖出日历价差（空头）**',
    '**波动率下降获利**：是少数能从隐含波动率下降中直接获利的策略之一。',
    '**收取权利金**：通常在建立策略时能获得净权利金收入。',
  ],
  cons: [
    '#### **买入日历价差（多头）**',
    '**波动率风险**：如果波动率下降，对策略不利，可能导致亏损。',
    '**股价敏感**：股价大幅偏离执行价时，策略效果不佳。',
    '**管理复杂**：需要密切关注近月期权到期日，进行展期或平仓。',
    '#### **卖出日历价差（空头）**',
    '**时间价值劣势**：时间流逝对策略不利，会持续侵蚀利润。',
    '**波动率风险**：如果隐含波动率上升，将导致亏损。',
    '**风险较高**：理论上，如果波动率无限上升，亏损可能很大。',
  ],
  example: (
    <div>
      <h4>买入日历价差示例（预期波动率上升）</h4>
      <p>假设某股票现价100元，你预期短期内股价会相对稳定，但波动率可能上升。于是你建立了一个买入日历价差：</p>
      <ul>
        <li>卖出1张下月到期、执行价100元的看涨期权，收入2元（共200元）。</li>
        <li>买入1张6个月后到期、执行价100元的看涨期权，支付4元（共400元）。</li>
      </ul>
      <p>你的净成本为 <strong>200元</strong>（400元 - 200元），这是你的最大潜在亏损。</p>
      <p><strong>理想情况</strong>：近月期权到期时，股价仍在100元附近，且隐含波动率上升。此时近月期权价值归零，而远月期权因波动率上升和仍有较长时间价值而价格上涨，你将获利。</p>
      <hr style={{ margin: '20px 0' }} />
      <h4>卖出日历价差示例（预期波动率下降）</h4>
      <p>假设某股票现价100元，刚刚发布财报后，你预期市场将回归平静，隐含波动率会大幅下降。于是你建立了一个卖出日历价差：</p>
      <ul>
        <li>买入1张下月到期、执行价100元的看涨期权，支付3元（共300元）。</li>
        <li>卖出1张6个月后到期、执行价100元的看涨期权，收入5元（共500元）。</li>
      </ul>
      <p>你获得了 <strong>200元</strong> 的净权利金收入（500元 - 300元），这是你的最大潜在利润。</p>
      <p><strong>理想情况</strong>：隐含波动率如期大幅下降。虽然时间流逝对你不利（你买的近月期权价值衰减快），但波动率下降对你卖出的远月期权更有利，其价格下降幅度超过近月期权，从而使整个头寸获利。</p>
    </div>
  ),
  formula: [
    '**买入日历价差**：',
    '净成本 = 远月期权价格 - 近月期权价格',
    '最大风险 = 净成本',
    '**卖出日历价差**：',
    '净收入 = 远月期权价格 - 近月期权价格',
    '最大利润 = 净收入',
  ],
  legs: [
    { id: 'sc_near', kind: 'option', position: 'short', qty: 1, multiplier: 100, entryPrice: 2, option: { type: 'call', strike: 100 } },
    { id: 'lc_far', kind: 'option', position: 'long', qty: 1, multiplier: 100, entryPrice: 4, option: { type: 'call', strike: 100 } },
  ],
}

export default strategy
